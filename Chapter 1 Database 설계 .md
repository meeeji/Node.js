# 🎯 핵심 키워드

---

</aside>

- 외래키
    - Foreign key (FK)
    - 외래 키 테이블에 저장될 수 있는 데이터를 제어하기 위해 두 테이블의 데이터 간에 링크를 설정하고 적용하는 데 사용되는 열 또는 열의 조합
    - 한 테이블에 대한 기본 키 값을 포함하는 열이 다른 테이블의 열에서 참조될 때, 두 테이블 사이에 링크가 생성됨. 이 열이 두 번째 테이블에서 외래 키가 됨.
    - 테이블의 데이터를 병합하는 '조인'에서 자주 사용됨.
    - <제약 조건> : 두 테이블의 데이터에 대한 연결이 끊어져 고아 항목이 발생하지 않기 위함.
        1. 테이블 내 변경 사항이 외래 키 테이블의 데이터에 대한 링크를 무효화하는 경우, 기본 키 테이블의 데이터를 변경할 수 없도록 보장하여 Referential integrity(* 참조 무결성 : 데이터베이스에서 참고 관계를 안정적으로 유지하기 위함으로, 두 개의 테이블 간 관계가 유효하도록 유지하는 것)
        2. 외래 키 테이블에서 먼저 데이터를 삭제/변경해야함.
    - <연계 참조 무결성>
        1. NO ACTION : 부모 테이블의 행에 대한 삭제/업데이트 동작이 롤백.
        2. CASCADE : 부모 테이블에서 행이 삭제/업데이트 될 때 참조 테이블에서도 같은 동작이 수행됨.
        3. SET NULL : 부모 테이블에서 해당 행을 삭제/업데이트하면 해당 외래 키를 구성하는 모든 값이 NULL로 설정됨. 이를 위해서는 외래 키 열이 NULL을 허용해야함.
        4. SET DEFAULT : 부모 테이블에서 해당 행을 삭제/업데이트하면 외래 키를 구성하는 모든 값이 기본값으로 설정됨. 이를 위해서는 모든 외래 키 열에 기본 정의가 있어야 함.
- 기본키
    - Primary key (PK)
    - 테이블에는 각 행을 고유하게 식별하는 값을 가진 열 또는 조합이 포함되어 있는데, 이러한 열이나 열 조합을 테이블의 기본 키라고 함.
    - 테이블에 Entity Integrity(* 엔터티 무결성 : 데이터를 정확하고 신뢰할 수 있도록 유지하기 위한 개념으로, 각 행이 고유하고 식별 가능하도록 보장하는 제약 조건)을 적용함.
    - 둘 이상의 열에 기본 키 제약 조건이 정의된 경우 값은 한 열 내에서 중복 가능하지만, 기본 키 제약 조건 정의의 모든 열에서 값의 각 조합은 고유해야 함.
    - <제한 사항>
        1. 테이블은 하나의 기본 키 제약 조건만을 포함함.
        2. 기본 키는 16개의 열과 900바이트의 총 길이를 초과할 수 없음.
        3. 기본 키 제약 조건 내에서 정의된 모든 열은 NOT NULL로 정의됨.
- ER 다이어그램
    - Entity-Relationship Model
    - 개념 모델링으로 개체(entity), 속성(attribute), 관계성(relationship)을 표현함.
    - 구조화된 데이터에 대한 일련의 표현
    - <특징>
        1. 개체와 속성, 관계를 그림으로 표현
        2. 시스템에 영향 받지 않아 고려할 필요가 없음.
        3. 여러 형태의 관계 확인 가능
        4. 설계 변경이 거의 발생하지 않아서 데이터 중심의 설계가 가능함.
        5. 하나의 개체가 물리적으로 하나의 테이블이 되는 것은 아님.
    - <속성>
        1. 단순/복합 속성
        1.1. 단순 속성 : 더 이상 작은 구성요소로 나눌 수 없는 속성 ex)이름, 성별, 나이
        1.2. 복합 속성 : 더 작은 구성요소로 나눌 수 있는 속성, 들여쓰기로 표현 ex)주소, 생년월일
        2. 단일값/다중값 속성
        2.1. 단일값 속성 : 하나의 개체에 하나의 값을 갖는 속성 ex)이름, 나이
        2.2. 다중값 속성 : 하나의 개체에 여러 개의 값을 갖는 속성, {}로 표현 ex)전화번호
        3. 유도/저장 속성
        3.1. 유도 속성 : 다중 속성의 값으로부터 값이 유추 가능한 속성, ()로 표현 ex)나이(생년월일로 유추 가능)
        3.2. 저장 속성 : 유도 속성에 사용되는 속성 ex)이름, 번호, 생년월일
    - <제약 조건> : 데이터의 정확성을 높이기 위해 데이터가 준수해야하는 제약 조건
        1. 사상수 : 각각의 개체가 맺을 수 있는 관계의 수 명시 ex)1:1, 1:N, N:1, N:M
        2. 참가 제약조건
        2.1. 전체적 참가 : 모든 개체가 집합에 참여, 이중선으로 표현
        2.2. 부분적 참가 : 일부 개체가 집합에 참여, 단일선으로 표현
    - <특수 속성>
        1. 관계 집합의 속성 : 두 개체 집합의 관계에서 생성되는 값을 저장하는 속성 ex)수강신청 시각
        2. 재귀적 관계 : 자기 자신과 관계 집합 형성
        3. 약한/강한 개체 집합
        3.1. 약한 개체 집합 : 개체의 존재 유무가 관계를 맺고 있는 개체에 종속되는 집합, 관계와 개체 모두 이중선으로 표현
        3.2. 강한 개체 집합 : 약한 개체 집합과 연결되는 일반 개체 집합
    - <작성 순서>
        1. 엔터티 도출, 그림.
        2. 엔터티 배치
        3. 엔터티 간의 관계 설정
        4. 관계명 서술
        5. 관계 참여도 표현
        6. 관계의 필수 여부 표현
- 복합 키
    - 원래 테이블에 한 개의 PK(기본키)만 존재할 수 있지만, 두 개 이상의 컬럼을 PK(기본 키)로 지정하여 테이블의 각 행을 고유하게 식별하는 역할을 수행함.
    - 여러 개를 사용하는 경우, 자연스럽게 럼 순서가 정해지며, 중복이 적은 순서대로 작성해야함.
    - 복합키도 결국 여러 개의 컬럼을 기본키로 설정하는 것이기에 유일성과 최소성을 만족해야함.
    - <유용성>
        1. 데이터 무결성 보장 : 한 테이블 내의 특정 칼럼 조합의 고유성을 보장할 수 있음. 이를 통해 데이터 중복을 방지하고 무결성을 유지함.
        2. 정규화 : 데이터베이스 설계의 정규화 과정에서 발생하는 테이블 간의 관계를 나타내는 데 유용하게 사용됨.
    - <사용 방법>
        1. 이름을 명시적으로 설정하고 싶은 경우 : CONSTRAINT (키이름) PRIMARY KEY (사용컬럼)
        -> 이 경우, PK를 삭제하거나 수정하기 쉬움.
        2. 이름을 명시적으로 설정하지 않는 경우 : PRIMARY KEY (사용컬럼)
        -> 이 경우, 이름이 자동으로 생성됨. 따로 이름 지정을 해주지 않기 때문에 기본적인 복합 키만 필요할 때 사용함.
- 연관관계
    - 두 도메인(객체, 테이블)이 서로 논리적인 의미를 갖고 양쪽을 참조하는 관계를 의미
    
    [객체]
    
    - <방향>
        1. 단방향 연관관계 : 참조용 필드를 한쪽만 갖고 있는 구조로, 참조용 필드를 갖고 있는 클래스만이 반대편의 클래스를 참조할 수 있음.
        2. 양방향 연관관계 : 참조용 필드를 양쪽 모두 갖고 있는 구조로, 양쪽의 클래스 모두 반대편의 클래스를 참조할 수 있음. 양방향 관계를 단방향 관계 2개로 이루어졌으며, 외래 키 하나로 관리함.
    - <주인> : 외래키를 가지고 있는 테이블이 해당 연관관계의 주인이 됨. 주인 테이블만이 외래키를 관리할 수 있고, 주인의 반대편 테이블은 단순 읽기만 가능함.
    
    [테이블]
    
    - <유형>
        1. 1:1 관계 : 하나의 엔터티가 다른 하나의 엔터티와 연결 ex)사람 - 학번
        2. 1:N 관계 : 하나의 엔터티가 다른 엔터티 여러 개와 연결 ex)교수 - 수업
        3. N:M 관계 : 여러 엔터티가 다른 엔터티 여러 개와 연결, 조인 테이블 사용 ex)학생 - 강의
- 정규화
    
    [정보처리 실기_데이터베이스06강_정규화](https://youtu.be/RXQ1kZ_JHqg?si=f0OPsoOWnJXSbqca)
    
    - 효율적인 데이터베이스 설계와 관리를 위한 과정으로 데이터 추가/수정/삭제 진행 시 발생하는 문제들을 예방함.
    - 데이터의 중복성을 줄이고 무결성과 정확성을 향상시키는 데에 목적이 있음.
    - 여러 단계로 구성되어 있으며 이를 '정규형'이라고 부름.
    - <정규형>
        1. 제 1정규형 (1NF) : 모든 레코드가 유일하게 식별되어야 하며, 각 열은 더 이상 분할할 수 없는 값이어야 함.
        2. 제 2정규형 (2NF) : 1NF를 만족하면서, 기본 키의 '부분적 종속성'을 제거해야 함. ex) (학생ID, 이름, 과목, 과목 별 선생님, 선생님 메일) 컬럼을 갖는 테이블에서 (과목 별 선생님, 선생님 메일) 컬럼이 과목에 종속되어 있으므로 이를 분리해주어야 함.
        3. 제 3정규형 (3NF) : 2NF를 만족하면서, 비 기본 키가 다른 비 기본 키에 의존하는 '이행적 종속성'을 제거해야 함. ex) (과목, 선생님, 선생님 이메일) 컬럼을 가질 때, 비 기본 키인 선생님에 선생님 이메일이 종속되어 있으므로 (과목, 선생님) / (선생님, 선생님 이메일) 테이블로 분리하여야 함.
    - <장점>
        1. DB 변경 시 이상현상(Anomaly) 제거
        2. 저장 공간의 최소화
        3. 데이터 구조의 안전성 및 무결성 유지
        4. 데이터 삽입/삭제/수정 시 테이블의 재구성 필요성 감소
    - <단점>
        1. 릴레이션 간의 Join 연산 증가로 인한 응답 시간 저하
- 반 정규화
    - 의도적으로 정규화 원칙을 위배하는 행위
    - 데이터베이스의 성능과 속도 향상을 위해 중복을 허용하고 테이블을 통합해 조인을 줄이는 성능 향상 방법
    - 정규화가 끝난 후 성능 이슈가 있을 경우 진행하며, 정규화처럼 일정한 규칙이 존재함.
    - <반정규화 대상>
        1. 수행 속도가 많이 느린 경우
        2. 테이블의 조인 연산을 지나치게 사용해, 데이터 조회가 기술적으로 어려운 경우
        3. 테이블에 많은 데이터가 있고, 다량의 범위/특정 범위를 자주 처리해야하는 경우
    - <적용 방법>
        1. 중복 데이터를 허용해 테이블 구조 단순화
        2. 정규화된 테이블 병합
        3. 계산된 값을 미리 저장(캐싱)
    - <장점>
        1. 빠른 데이터 조회 가능
        2. 조인을 제거함으로써 검색 시간 최적화
    - <단점>
        1. 데이터의 삽입/삭제/수정 등 갱신 시 비용이 높아짐.
        2. 데이터간의 일관성을 보장할 수 없음.
        3. 많은 저장 공간이 필요함.

## 📢 학습 후기

---

💡 키워드를 정리하면서 여러 자료를 찾아본 것이 핵심 개념 정리에 도움이 된 것 같다. 아직 개념 정리만 완벽히 된 상태라, 반복적인 실습/미션을 통해 좀 더 확실히 공부해보아야겠다.

</aside>


## ✅ 실습 체크리스트

---

- [x]  ‘요구 사항’을 토대로 ERD 설계해보기
- [x]  ‘로컬 DB’ 설정하기

## ☑️ 실습 인증

---

1. ‘요구 사항’을 토대로 ERD 설계해보기

![image](https://github.com/user-attachments/assets/9cc47bae-800f-46cc-8cc5-8519f778e505)


1. ‘로컬 DB’ 설정하기

![image](https://github.com/user-attachments/assets/2a72f6e2-ef14-410c-935f-d839e960db50)


## 🔥 미션

---

    
1. 주어진 IA(기획 플로우)와 와이어 프레임(디자인 프로토타입)을 보고 직접 데이터베이스를 설계해오기, 위에서 언급한 경우를 다 적용해서 할 것
2. 이름 글자 수 등 세부적인 부분은 원하는 대로 해도 됨!
3. 각 지역 별로 가게들이 있으며 가게를 방문하는 미션을 해결하며 포인트를 모으는 서비스
    1. 모든 지역마다 10개의 미션 클리어시 1000 point 부여로 고정

**최소한 로그인/회원가입, 미션, 홈 화면에 필요한 데이터는 설계를 해야함, 되어있지 않다면 원 아웃**

***미션 난이도 완화를 위해 지도 검색 기능 전부 pass, 저 부분은 설계 하지 마세요***

***내 포인트 관리, 알 부분도 설계하지 마세요***

***사장님이 자신의 점포 관리하는 부분도 설계 대상에서 제외입니다.***

물론 원하시면 하셔도 됩니다. 😉


## 💪 미션 기록

---


</aside>

- **미션 기록**
    1. 먼저 제공 받은 자료를 보며 필요한 entity를 설정, 전체적인 틀을 구상했다.
        - 사용자(이름,아이디, 이메일, 성별 등을 기록하며, 탈퇴가 가능함.)
        - 선호 항목(중식, 양식, 한식 등으로 사용자가 회원 가입을 할 때에 필수적으로 설정하여야 함.)
        - 지역(점포가 위치해 있는 지역들로, 지역별로 사용자가 몇 개의 미션을 완료했는지 알 수 있어야 함.)
        - 점포(각 점포 별 저장되어 있는 정보 : 점포 이름, 위치, 영업 시간, 포인트, 평점 등)
        - 리뷰(사용자가 리뷰를 작성하고, 그 리뷰는 점포와 연결되어야 함.)
        - 미션(사용자는 각 점포에 연결된 미션을 수행하고, 진행 상태를 볼 수 있어야 함.)
        - 문의하기(사용자는 1:1 문의를 남길 수 있으며, 사용자는 여러 문의 유형을 선택할 수 있고 답변 상태 또한 확인 가능함.)
    2. 설정한 entity를 토대로, 각 테이블의 컬럼을 구성해보면서 테이블을 구상했다.
    
    ![image](https://github.com/user-attachments/assets/a9b751fe-ed95-4535-80ae-d21ab6fd3af7)


    
    3. 구상한 테이블을 바탕으로, 실제 테이블을 설계해보았다.(ERD CLOUD 사용)
    4. 각 테이블 간의 관계를 생각하며 관계선을 연결시켜주었다.
    
    ![image](https://github.com/user-attachments/assets/e3ebfc1a-82aa-474e-9ef5-e456db8f8e6c)

    
    5. [피드백]
    - gender, sns_provider와 같이 입력 값을 제공받는 경우, enum으로 enum을 이용해 더 효율적으로 관리할 것
    - 중복되는 FK를 확인할 것
    - 리뷰/QnA 이미지는 여러 장 업로드가 가능하다는 점을 명심할 것
    - QnA_type은 하나의 QnA 당 1개라는 점을 명시할 것
    6. 피드백을 반영하여 ERD를 수정해보았다. 중복되는 FK를 삭제하고, 리뷰/QnA 이미지는 여러 장 업로드가 가능하다는 점을 확인, 이미지 테이블을 따로 설계했다. 또, gender, sns_provider, QnA_type 관련 컬럼을 수정하였다.
    
   ![image](https://github.com/user-attachments/assets/a2cf475c-3738-48e8-8745-2b48af9065d7)

    
    7. [2차 피드백]
    - 사용자가 로그인을 할 때, 사용자로부터 약관 동의를 받음. 이 내용을 첨가할 것.
    8. 2차 피드백을 반영하여, ERD를 수정해보았다. 약관 동의를 반영하기 위해 약관/동의 테이블을 첨가하였다.
    
    ![image](https://github.com/user-attachments/assets/bdb88082-e1b0-4725-bed1-a34db47d3694)

    

## ⚡ 트러블 슈팅

---

</aside>

- ⚡이슈 No.1
    
    **`이슈`**
    
    👉 ’소셜 로그인’ 형식을 통해, 사용자가 가지고 있는 계정에서 계정 정보를 불러와 User 테이블에 저장할 때, 이와 관련한 컬럼을 설정하지 못함.
    
    **`문제`**
    
    👉 여러 소셜 계정 중 하나를 선택하고, 그 계정으로부터 정보를 불러오는 과정에서 사용자 테이블에 저장해야 하는 정보에 대한 지식이 부족했음.
    
    **`해결`**
    
    👉  우선 사용자가 선택하는 소셜 계정 정보를 저장한 다음, 그 계정으로부터 불러와지는 id를 저장하도록 함.
    
    **`참고레퍼런스`**
    
    - https://devmuromi.tistory.com/m/entry/%EC%86%8C%EC%85%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B8-DB-%EA%B5%AC%EC%A1%B0%EB%A5%BC-%EA%B5%AC%EC%83%81%ED%95%98%EB%A9%B0

## 🤔 참고 자료

[1주차](Chapter%201%20Database%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%80%E1%85%A8%201b7b57f4596b80dc8918ca9769a63f78/1%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%201b7b57f4596b817a97dbc1fd48a8e942.csv)

---
